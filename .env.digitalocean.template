# ============================================
# DIGITAL OCEAN ENVIRONMENT VARIABLES TEMPLATE
# ============================================
# GGDS Benevolent Fund - Production Deployment
#
# This file contains all environment variables needed for Digital Ocean deployment.
# Copy these values to Digital Ocean App Platform dashboard:
# Settings > Environment Variables > Edit Component
#
# IMPORTANT: Mark all SECRET variables as "Encrypted" in Digital Ocean dashboard
#

# ============================================
# BACKEND ENVIRONMENT VARIABLES (ggds-backend)
# ============================================

# --- AUTO-CONFIGURED BY DIGITAL OCEAN (No manual action needed) ---
# DATABASE_URL              - Auto-populated from PostgreSQL database
# FRONTEND_URL              - Auto-populated from frontend service URL
# APP_NAME                  - Set in app.yaml: "GGDS Benevolent Fund API"
# APP_ENV                   - Set in app.yaml: "production"
# DEBUG                     - Set in app.yaml: "false"
# ALGORITHM                 - Set in app.yaml: "HS256"
# ACCESS_TOKEN_EXPIRE_MINUTES - Set in app.yaml: "30"
# REFRESH_TOKEN_EXPIRE_DAYS   - Set in app.yaml: "7"
# LOG_LEVEL                 - Set in app.yaml: "INFO"


# --- SECURITY: JWT Secret Key (REQUIRED - SECRET) ---
# Generate using: openssl rand -hex 32
# Type: SECRET (Mark as Encrypted in DO dashboard)
SECRET_KEY=<GENERATE_AND_PASTE_HERE>
# Example: openssl rand -hex 32
# Result: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6


# --- HOSTINGER SMTP EMAIL SERVICE ---
# Get credentials from Hostinger hPanel > Email Accounts

# SMTP Server (Usually smtp.hostinger.com)
# Type: PLAIN (Already set in app.yaml)
SMTP_HOST=smtp.hostinger.com

# SMTP Port (587 for TLS, 465 for SSL)
# Type: PLAIN (Already set in app.yaml)
SMTP_PORT=587

# SMTP Username (Your email address)
# Type: SECRET (Mark as Encrypted)
SMTP_USERNAME=lifeline@ggdi.net

# SMTP Password (Your email password from hPanel)
# Type: SECRET (Mark as Encrypted)
SMTP_PASSWORD=<YOUR_EMAIL_PASSWORD>

# Use TLS Encryption
# Type: PLAIN (Already set in app.yaml)
SMTP_USE_TLS=true

# From Email Address (displayed as sender)
# Type: PLAIN (Already set in app.yaml)
EMAIL_FROM=lifeline@ggdi.net

# Admin Email (receives system notifications)
# Type: PLAIN (Already set in app.yaml)
ADMIN_EMAIL=lifeline@ggdi.net


# --- DIGITAL OCEAN SPACES (File Storage) ---
# Create Spaces bucket and generate API keys from:
# Digital Ocean Dashboard > Spaces > Create Space

# Spaces Region (Choose closest to your users)
# Options: nyc3, sfo3, ams3, sgp1, fra1
# Type: PLAIN (Already set in app.yaml)
SPACES_REGION=fra1

# Spaces Bucket Name (Must be unique globally)
# Type: PLAIN (Already set in app.yaml)
SPACES_BUCKET=ggds-benevolent-fund-files

# Spaces Access Key (Generate from API > Spaces Keys)
# Type: SECRET (Mark as Encrypted)
SPACES_ACCESS_KEY=<YOUR_SPACES_ACCESS_KEY>
# Example: DO00ABC123XYZ456

# Spaces Secret Key (Generated with Access Key)
# Type: SECRET (Mark as Encrypted)
SPACES_SECRET_KEY=<YOUR_SPACES_SECRET_KEY>
# Example: abcdefghijklmnopqrstuvwxyz1234567890ABCD


# --- OPTIONAL: MONITORING & ERROR TRACKING ---
# Sentry DSN for error monitoring (Optional but recommended)
# Get from: https://sentry.io
# Type: SECRET (Mark as Encrypted)
# SENTRY_DSN=<YOUR_SENTRY_DSN>


# ============================================
# FRONTEND ENVIRONMENT VARIABLES (ggds-frontend)
# ============================================

# --- AUTO-CONFIGURED BY DIGITAL OCEAN (No manual action needed) ---
# NODE_ENV                  - Set to "production"
# NEXT_PUBLIC_API_URL       - Auto-populated from backend service URL
# NEXT_PUBLIC_SITE_NAME     - Set in app.yaml
# NEXT_PUBLIC_SITE_DESCRIPTION - Set in app.yaml

# All frontend variables are auto-configured. No manual setup needed! ✅


# ============================================
# SETUP INSTRUCTIONS
# ============================================

# STEP 1: Generate SECRET_KEY
# -------------------------------
# Run this command in your terminal:
#   openssl rand -hex 32
# Copy the output and paste it as SECRET_KEY value above

# STEP 2: Configure Hostinger Email
# -------------------------------
# 1. Log in to Hostinger hPanel: https://hpanel.hostinger.com
# 2. Go to "Email Accounts"
# 3. Use existing email: lifeline@ggdi.net (or create if needed)
# 4. Note down the email password
# 5. Update SMTP_PASSWORD above (SMTP_USERNAME is already set to lifeline@ggdi.net)

# STEP 3: Create Digital Ocean Space
# -------------------------------
# 1. Go to: https://cloud.digitalocean.com/spaces
# 2. Click "Create Space"
# 3. Choose Region: Frankfurt (fra1) - or closest to your users
# 4. Choose name: ggds-benevolent-fund-files
# 5. Set File Listing: "Private" (Restricted)
# 6. Enable CDN: Optional (recommended for faster delivery)
# 7. Click "Create Space"

# STEP 4: Generate Spaces API Keys
# -------------------------------
# 1. Go to: API > Spaces Keys (https://cloud.digitalocean.com/account/api/spaces)
# 2. Click "Generate New Key"
# 3. Name: "GGDS Backend"
# 4. Copy Access Key and Secret Key
# 5. Update SPACES_ACCESS_KEY and SPACES_SECRET_KEY above
# ⚠️  IMPORTANT: Save the Secret Key now - you won't see it again!

# STEP 5: Set Environment Variables in Digital Ocean
# -------------------------------
# 1. Go to your app: https://cloud.digitalocean.com/apps
# 2. Click on "ggds-benevolent-fund"
# 3. Go to "Settings" > "ggds-backend" component
# 4. Scroll to "Environment Variables"
# 5. Click "Edit"
# 6. Add each SECRET variable:
#    - Click "Add Variable"
#    - Enter Key (e.g., SECRET_KEY)
#    - Enter Value (the actual secret)
#    - Check "Encrypt" checkbox
#    - Click "Save"
# 7. Repeat for all SECRET variables:
#    ✓ SECRET_KEY
#    ✓ SMTP_USERNAME
#    ✓ SMTP_PASSWORD
#    ✓ ADMIN_EMAIL
#    ✓ SPACES_ACCESS_KEY
#    ✓ SPACES_SECRET_KEY
# 8. Click "Save" at the bottom
# 9. Your app will automatically redeploy with new variables


# ============================================
# VERIFICATION CHECKLIST
# ============================================

# Before going live, verify:
# ☐ SECRET_KEY is generated (32+ characters)
# ☐ Hostinger email account is created and tested
# ☐ SMTP credentials are correct
# ☐ Digital Ocean Space is created with correct region
# ☐ Spaces API keys are generated
# ☐ All SECRET variables are marked as "Encrypted" in DO
# ☐ App has redeployed successfully
# ☐ Test email sending from app
# ☐ Test file upload to Spaces
# ☐ Check app logs for any errors


# ============================================
# TESTING AFTER DEPLOYMENT
# ============================================

# Test Email Service:
# -------------------
# 1. Create a test user via the app
# 2. Check if welcome email is received
# 3. Monitor backend logs for email send confirmations
# Log: "✉️  Email sent to user@example.com"

# Test File Upload:
# -------------------
# 1. Try uploading a document (PDF, image, etc.)
# 2. Verify file appears in Digital Ocean Spaces:
#    - Go to Spaces > ggds-benevolent-fund-files
#    - Check if file is listed
# 3. Try accessing the uploaded file URL
# 4. Check backend logs for upload confirmations

# Check Logs:
# -------------------
# Via doctl CLI:
#   doctl apps logs <APP_ID> --component ggds-backend --follow
#
# Via Dashboard:
#   App > Runtime Logs > ggds-backend


# ============================================
# TROUBLESHOOTING
# ============================================

# Email not sending:
# - Verify SMTP credentials in Hostinger
# - Check SMTP_PORT (587 for TLS, 465 for SSL)
# - Verify email account exists and is active
# - Check firewall/security settings in Hostinger
# - Look for errors in app logs

# File upload failing:
# - Verify Spaces bucket exists and is accessible
# - Check SPACES_ACCESS_KEY and SPACES_SECRET_KEY
# - Verify bucket permissions (set to Private)
# - Check if CORS is configured in Spaces (if accessing from browser)
# - Look for errors in app logs

# App won't start:
# - Check all required SECRET variables are set
# - Verify DATABASE_URL is auto-populated
# - Check build logs for errors
# - Ensure Python dependencies installed correctly


# ============================================
# SECURITY NOTES
# ============================================

# ⚠️  NEVER commit this file with actual secrets to Git!
# ⚠️  Keep your API keys secure and rotate them regularly
# ⚠️  Use different credentials for staging/production
# ⚠️  Enable 2FA on your Digital Ocean account
# ⚠️  Monitor Spaces usage to detect unauthorized access
# ⚠️  Set up billing alerts to avoid surprise charges
# ⚠️  Regularly review access logs


# ============================================
# SUPPORT
# ============================================

# Digital Ocean Documentation:
# - App Platform: https://docs.digitalocean.com/products/app-platform/
# - Spaces: https://docs.digitalocean.com/products/spaces/
# - Managed Databases: https://docs.digitalocean.com/products/databases/

# Hostinger Documentation:
# - Email Setup: https://support.hostinger.com/en/collections/3649074-email

# Need Help?
# - Check DIGITALOCEAN_DEPLOYMENT.md for detailed guide
# - Review application logs for errors
# - Contact support@ggds.org
